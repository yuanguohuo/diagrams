<mxfile host="app.diagrams.net" modified="2024-07-03T07:18:00.266Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36" etag="E2X4DkkADSgOEsFmg38_" version="24.6.4" type="device" pages="5">
  <diagram id="p-6dqNqKRs0oVdc7MsmJ" name="PutObject的数据流">
    <mxGraphModel dx="2714" dy="3650" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-244" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="-730" width="1920" height="810" as="geometry" />
        </mxCell>
        <mxCell id="7pKSro87sIzUiZ5dmb2D-1" value="&lt;h1 style=&quot;text-align: center;&quot;&gt;Put Atomic Object&lt;/h1&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;Helvetica&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;一个S3 object拆分成多个RADOS objects:&lt;/span&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&amp;nbsp; &amp;nbsp;head object :&amp;nbsp; 第一个RADOS object;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&amp;nbsp; &amp;nbsp;tail objects&amp;nbsp; :&amp;nbsp; 除head object之外的RADOS objects;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;两种size:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&amp;nbsp; stripe size : RADOS object的大小；影响数据分布；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&amp;nbsp; chunk size : 读写RADOS object的IO的大小；影响内存占用；&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;这两者不是同一个概念，可以不相同（虽然默认配置是相同的都是4MB），但对于head object，这两者是相等的，&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;因为整个head object必须作为一个整体原子地写入。&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;另外注意：&lt;/font&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;head object和tail objects 可以放在不同的pool里，此时head object的size为0。&lt;/font&gt;&lt;span style=&quot;font-family: KKB1j7KVpntRksyuQkXU; background-color: initial;&quot;&gt;例如：bucket的storage class是Standard(3副本pool)，put object时指定的storage class是IA (EC pool)。那么head object就在3副本pool中，size为0，attrs中存着manifest，通过manifest可以找到tail objects；tail objects在EC pool中。&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: KKB1j7KVpntRksyuQkXU; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: KKB1j7KVpntRksyuQkXU; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;&lt;font face=&quot;KKB1j7KVpntRksyuQkXU&quot;&gt;AtomicObjectProcessor::prepare()函数确定这些size。&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font face=&quot;jUiy2CmNKml7zNn6GF_3&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="80" y="-1160" width="770" height="390" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-1" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="-650" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-5" value="recv stream" style="shape=dataStorage;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="-285" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-6" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-5" target="hoMMu7_Y5KZb3ijvRSbR-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="-610" as="sourcePoint" />
            <mxPoint x="770" y="-660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-9" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;[0, 4M):&amp;nbsp; HeadObjectProcessor::process()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-6" vertex="1" connectable="0">
          <mxGeometry x="0.1248" relative="1" as="geometry">
            <mxPoint x="-2" y="9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-8" value="HeadObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="610" y="-680" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-10" value="在内存(first_chunk)中缓存" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1120" y="-650" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-11" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-1" target="hoMMu7_Y5KZb3ijvRSbR-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="-620" as="sourcePoint" />
            <mxPoint x="770" y="-670" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-15" value="AtomicObjectProcessor::process_first_chunk()" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-11" vertex="1" connectable="0">
          <mxGeometry x="-0.2" y="-1" relative="1" as="geometry">
            <mxPoint x="30" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-13" value="head object已满&lt;br&gt;&amp;nbsp;(4M)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="850" y="-665" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-16" value="AtomicObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1175" y="-680" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-17" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="-290" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-18" value="StripeProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="615" y="-320" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-19" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-5" target="hoMMu7_Y5KZb3ijvRSbR-17" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="-460" as="sourcePoint" />
            <mxPoint x="645" y="-590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-20" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;[4M, ...):&amp;nbsp;&amp;nbsp;StripeProcessor::process()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-19" vertex="1" connectable="0">
          <mxGeometry x="0.1248" relative="1" as="geometry">
            <mxPoint x="-16" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-22" target="hoMMu7_Y5KZb3ijvRSbR-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-36" value="RadosWriter::process()" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-35" vertex="1" connectable="0">
          <mxGeometry x="-0.04" y="5" relative="1" as="geometry">
            <mxPoint y="5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-22" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1120" y="-290" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-23" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-17" target="hoMMu7_Y5KZb3ijvRSbR-22" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="730" y="-410" as="sourcePoint" />
            <mxPoint x="780" y="-460" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-25" value="ChunkProcessor::process()" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-23" vertex="1" connectable="0">
          <mxGeometry x="-0.0655" relative="1" as="geometry">
            <mxPoint x="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-24" value="ChunkProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1175" y="-320" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-26" value="当前stripe未满" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="850" y="-300" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-27" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-17" target="hoMMu7_Y5KZb3ijvRSbR-17" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="730" y="-410" as="sourcePoint" />
            <mxPoint x="890" y="-150" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1010" y="-130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-30" value="ManifestObjectProcessor::next()" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-27" vertex="1" connectable="0">
          <mxGeometry x="0.5919" y="1" relative="1" as="geometry">
            <mxPoint x="83" y="-19" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-29" value="当前stripe已满&lt;br&gt;生成新的stripe，即新的rados object" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="830" y="-200" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-33" value="写入RADOS&lt;br&gt;并在written中记当前rados object" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1600" y="-290" width="230" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-34" value="RadosWriter" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1685" y="-320" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-38" value="chunk已满" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1420" y="-300" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-39" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-1" target="hoMMu7_Y5KZb3ijvRSbR-1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="-410" as="sourcePoint" />
            <mxPoint x="980" y="-460" as="targetPoint" />
            <Array as="points">
              <mxPoint x="960" y="-410" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-40" value="在内存(head_data)中累积" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-39" vertex="1" connectable="0">
          <mxGeometry x="-0.6646" y="-1" relative="1" as="geometry">
            <mxPoint x="38" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-41" value="head object未满&lt;br&gt;&amp;nbsp;(4M)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="850" y="-540" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-42" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-22" target="hoMMu7_Y5KZb3ijvRSbR-22" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="-410" as="sourcePoint" />
            <mxPoint x="980" y="-460" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1550" y="-120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-43" value="在内存(chunk)中累积" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-42" vertex="1" connectable="0">
          <mxGeometry x="-0.639" y="-3" relative="1" as="geometry">
            <mxPoint x="34" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-44" value="chunk未满" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1420" y="-200" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-46" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;process({}, ...) //flush&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;complete();&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="-20" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-47" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-5" target="hoMMu7_Y5KZb3ijvRSbR-46" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="-260" as="sourcePoint" />
            <mxPoint x="980" y="-310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-48" value="EOF" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="hoMMu7_Y5KZb3ijvRSbR-47" vertex="1" connectable="0">
          <mxGeometry x="0.0475" y="3" relative="1" as="geometry">
            <mxPoint x="-20" y="-14" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-49" value="AtomicObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="615" y="-50" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-50" value="&lt;ol&gt;&lt;li&gt;原子地创建head rados object，写入缓存的first_chunk数据以及attrs；&lt;/li&gt;&lt;li&gt;在bucket shard的omap中创建index;&lt;/li&gt;&lt;/ol&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="730" y="-10" width="490" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-245" value="" style="rounded=1;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="80" y="120" width="1920" height="1260" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-73" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="1100" y="620" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-74" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1118" y="790" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-75" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="1410" y="620" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-82" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_2" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1428" y="790" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-83" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="1730" y="620" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-90" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_3" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1748" y="790" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-91" value="" style="rounded=0;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="560" y="360" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-92" value="recv stream" style="shape=dataStorage;whiteSpace=wrap;html=1;fixedSize=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="110" y="725" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-93" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-92" target="hoMMu7_Y5KZb3ijvRSbR-91" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="400" as="sourcePoint" />
            <mxPoint x="770" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-94" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;[0, 4M):&amp;nbsp; HeadObjectProcessor::process()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-93" vertex="1" connectable="0">
          <mxGeometry x="0.1248" relative="1" as="geometry">
            <mxPoint x="-2" y="9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-95" value="HeadObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="610" y="330" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-96" value="" style="rounded=0;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="560" y="720" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-97" value="StripeProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="615" y="690" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-98" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-92" target="hoMMu7_Y5KZb3ijvRSbR-96" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="550" as="sourcePoint" />
            <mxPoint x="645" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-99" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;[4M, ...):&amp;nbsp;&amp;nbsp;StripeProcessor::process()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-98" vertex="1" connectable="0">
          <mxGeometry x="0.1248" relative="1" as="geometry">
            <mxPoint x="-16" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-100" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;process({}, ...) //flush&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;complete();&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="560" y="990" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-101" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-92" target="hoMMu7_Y5KZb3ijvRSbR-100" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="750" as="sourcePoint" />
            <mxPoint x="980" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-102" value="EOF" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-101" vertex="1" connectable="0">
          <mxGeometry x="0.0475" y="3" relative="1" as="geometry">
            <mxPoint x="-20" y="-14" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-103" value="AtomicObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="615" y="960" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-109" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="782" y="940" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-116" value="RADOS object&lt;br&gt;{bucket_id}_{s3_object_name}" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="800" y="1116" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-117" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-109" target="hoMMu7_Y5KZb3ijvRSbR-73" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="730" as="sourcePoint" />
            <mxPoint x="980" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-120" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-117" vertex="1" connectable="0">
          <mxGeometry x="-0.0573" relative="1" as="geometry">
            <mxPoint x="-11" y="-95" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-118" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-109" target="hoMMu7_Y5KZb3ijvRSbR-75" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1040" y="1020" as="sourcePoint" />
            <mxPoint x="1225" y="860" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-121" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-118" vertex="1" connectable="0">
          <mxGeometry x="-0.0861" y="1" relative="1" as="geometry">
            <mxPoint x="134" y="-94" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-119" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-109" target="hoMMu7_Y5KZb3ijvRSbR-83" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1040" y="1025" as="sourcePoint" />
            <mxPoint x="1535" y="860" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-122" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-119" vertex="1" connectable="0">
          <mxGeometry x="-0.0807" y="-2" relative="1" as="geometry">
            <mxPoint x="281" y="-97" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-124" value="&lt;b&gt;假设：&lt;br&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;head和tail在同一个pool&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;stripe size = 4M;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;chunk size = 2M;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;每次从stream接收2M；&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="110" y="200" width="260" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-459" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;container=0;" parent="1" vertex="1">
          <mxGeometry x="772" y="283" width="250" height="200" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-67" value="内存&lt;br&gt;AtomicObjectProcessor的first_chunk字段" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="782" y="433" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-460" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-459" target="hoMMu7_Y5KZb3ijvRSbR-109" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="870" y="610" as="sourcePoint" />
            <mxPoint x="920" y="560" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ad7q9LseQ54Zxvk_9jEE-8" value="原子写入&lt;br&gt;O_CREAT | O_EXCL" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" vertex="1" connectable="0" parent="hoMMu7_Y5KZb3ijvRSbR-460">
          <mxGeometry x="-0.0518" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-64" value="[4M,6M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1136" y="660" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-65" value="2" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1146" y="660" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-69" value="[6M,8M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1216" y="660" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-70" value="3" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1226" y="660" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-77" value="[8M,10M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1446" y="660" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-78" value="4" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1456" y="660" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-80" value="[10M,12M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1526" y="660" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-81" value="5" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1536" y="660" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-85" value="[12M,14M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1766" y="660" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-86" value="6" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1776" y="660" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-88" value="[14M,15M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1846" y="660" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-89" value="7" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1856" y="660" width="60" height="15" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-111" value="[0M,2M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="820" y="980" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-112" value="0" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="830" y="980" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-114" value="[2M,4M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="900" y="980" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-115" value="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="910" y="980" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-52" value="[0,2M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;container=0;" parent="1" vertex="1">
          <mxGeometry x="817" y="303" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-55" value="0" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="827" y="303" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-105" value="[2,4M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;container=0;" parent="1" vertex="1">
          <mxGeometry x="897" y="303" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-106" value="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="907" y="303" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="MeA6OsmNIQnRj8AXK-dD-2" value="default.rgw.buckets.index" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="781" y="1230" width="380" height="90" as="geometry" />
        </mxCell>
        <mxCell id="MeA6OsmNIQnRj8AXK-dD-3" value=".dir.{bucket_marker}.{bucket_shard_#}&lt;br&gt;&amp;nbsp; &amp;nbsp; omap:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {s3_object_name}&amp;nbsp; &amp;nbsp; =&amp;gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;rgw_bucket_dir_entry" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="MeA6OsmNIQnRj8AXK-dD-2">
          <mxGeometry y="30" width="380" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-386" value="" style="rounded=1;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="80" y="1440" width="1920" height="1250" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-415" value="" style="rounded=0;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="560" y="1670" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-416" value="recv stream" style="shape=dataStorage;whiteSpace=wrap;html=1;fixedSize=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="110" y="2035" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-417" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-416" target="hoMMu7_Y5KZb3ijvRSbR-415" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="1710" as="sourcePoint" />
            <mxPoint x="770" y="1660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-418" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;[0, 4M):&amp;nbsp; HeadObjectProcessor::process()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-417" vertex="1" connectable="0">
          <mxGeometry x="0.1248" relative="1" as="geometry">
            <mxPoint x="-2" y="9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-419" value="HeadObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="610" y="1640" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-420" value="" style="rounded=0;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="560" y="2030" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-421" value="StripeProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="615" y="2000" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-422" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-416" target="hoMMu7_Y5KZb3ijvRSbR-420" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="1860" as="sourcePoint" />
            <mxPoint x="645" y="1730" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-423" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;[4M, ...):&amp;nbsp;&amp;nbsp;StripeProcessor::process()&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-422" vertex="1" connectable="0">
          <mxGeometry x="0.1248" relative="1" as="geometry">
            <mxPoint x="-16" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-424" value="&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;process({}, ...) //flush&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;complete();&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;container=0;" parent="1" vertex="1">
          <mxGeometry x="560" y="2300" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-425" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-416" target="hoMMu7_Y5KZb3ijvRSbR-424" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="2060" as="sourcePoint" />
            <mxPoint x="980" y="2010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-426" value="EOF" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-425" vertex="1" connectable="0">
          <mxGeometry x="0.0475" y="3" relative="1" as="geometry">
            <mxPoint x="-20" y="-14" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-427" value="AtomicObjectProcessor" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="615" y="2270" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-445" value="&lt;b&gt;假设：head和tail在不同pool&lt;br&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;stripe size = 4M;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;chunk size = 2M;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;每次从stream接收2M；&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="110" y="1510" width="260" height="120" as="geometry" />
        </mxCell>
        <mxCell id="ad7q9LseQ54Zxvk_9jEE-1" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;fillColor=#dae8fc;strokeColor=none;container=0;" vertex="1" parent="1">
          <mxGeometry x="770" y="1850" width="1210" height="340" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-387" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="1100" y="1930" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-398" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1118" y="2100" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-399" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="1410" y="1930" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-406" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_2" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1428" y="2100" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-407" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="1730" y="1930" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-414" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_3" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1748" y="2100" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-446" value="" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="790" y="1930" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-453" value="RADOS object&lt;br&gt;{bucket_id}__shadow_.{uniq_tag}_0" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="808" y="2100" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ad7q9LseQ54Zxvk_9jEE-2" value="&lt;font style=&quot;font-size: 13px;&quot;&gt;tail pool: 即put请求中storage-class对应的pool&amp;nbsp;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" vertex="1" parent="1">
          <mxGeometry x="1237.5" y="1860" width="275" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ad7q9LseQ54Zxvk_9jEE-6" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=none;container=0;" vertex="1" parent="1">
          <mxGeometry x="770" y="2220" width="420" height="280" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-431" value="&lt;b&gt;&lt;font face=&quot;Comic Sans MS&quot;&gt;Empty Data&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;container=0;" parent="1" vertex="1">
          <mxGeometry x="790" y="2250" width="230" height="230" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-438" value="RADOS object&lt;br&gt;{bucket_id}_{s3_object_name}" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="808" y="2426" width="194" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-439" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#ffe6cc;strokeColor=#000000;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-431" target="hoMMu7_Y5KZb3ijvRSbR-387" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="930" y="2040" as="sourcePoint" />
            <mxPoint x="980" y="1990" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-440" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-439" vertex="1" connectable="0">
          <mxGeometry x="-0.0573" relative="1" as="geometry">
            <mxPoint x="26" y="-95" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-441" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#ffe6cc;strokeColor=#000000;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-431" target="hoMMu7_Y5KZb3ijvRSbR-399" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1040" y="2330" as="sourcePoint" />
            <mxPoint x="1225" y="2170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-442" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-441" vertex="1" connectable="0">
          <mxGeometry x="-0.0861" y="1" relative="1" as="geometry">
            <mxPoint x="134" y="-94" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-443" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#ffe6cc;strokeColor=#000000;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-431" target="hoMMu7_Y5KZb3ijvRSbR-407" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1040" y="2335" as="sourcePoint" />
            <mxPoint x="1535" y="2170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-444" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-443" vertex="1" connectable="0">
          <mxGeometry x="-0.0807" y="-2" relative="1" as="geometry">
            <mxPoint x="281" y="-97" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-454" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#ffe6cc;strokeColor=#000000;" parent="1" source="hoMMu7_Y5KZb3ijvRSbR-431" target="hoMMu7_Y5KZb3ijvRSbR-446" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1022" y="2375" as="sourcePoint" />
            <mxPoint x="1225" y="2170" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1070" y="2365" />
              <mxPoint x="1070" y="2205" />
              <mxPoint x="905" y="2205" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-455" value="xattr:&amp;nbsp;&amp;nbsp;user.rgw.manifest" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];container=0;" parent="hoMMu7_Y5KZb3ijvRSbR-454" vertex="1" connectable="0">
          <mxGeometry x="-0.0573" relative="1" as="geometry">
            <mxPoint x="30" y="50" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ad7q9LseQ54Zxvk_9jEE-7" value="&lt;font style=&quot;font-size: 13px;&quot;&gt;head pool&lt;br&gt;即bucket的storage-class&lt;br&gt;对应的pool&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" vertex="1" parent="1">
          <mxGeometry x="1034" y="2432" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-392" value="[4M,6M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1136" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-393" value="2" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1146" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-396" value="[6M,8M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1216" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-397" value="3" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1226" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-401" value="[8M,10M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1446" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-402" value="4" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1456" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-404" value="[10M,12M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1526" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-405" value="5" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1536" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-409" value="[12M,14M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1766" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-410" value="6" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1776" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-412" value="[14M,15M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="1846" y="1970" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-413" value="7" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="1856" y="1970" width="60" height="15" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-448" value="[0M,2M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="826" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-449" value="0" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="836" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-451" value="[2M,4M)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;container=0;" parent="1" vertex="1">
          <mxGeometry x="906" y="1970" width="80" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hoMMu7_Y5KZb3ijvRSbR-452" value="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;container=0;" parent="1" vertex="1">
          <mxGeometry x="916" y="1970" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="MeA6OsmNIQnRj8AXK-dD-8" value="default.rgw.buckets.index" style="swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="790" y="2560" width="380" height="90" as="geometry" />
        </mxCell>
        <mxCell id="MeA6OsmNIQnRj8AXK-dD-9" value=".dir.{bucket_marker}.{bucket_shard_#}&lt;br&gt;&amp;nbsp; &amp;nbsp; omap:&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {s3_object_name}&amp;nbsp; &amp;nbsp; =&amp;gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;rgw_bucket_dir_entry" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingLeft=4;spacingRight=4;overflow=hidden;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rotatable=0;whiteSpace=wrap;html=1;" vertex="1" parent="MeA6OsmNIQnRj8AXK-dD-8">
          <mxGeometry y="30" width="380" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="KoOAMsRtD4qrsw1SdAsb" name="PutObject发生覆盖">
    <mxGraphModel dx="2074" dy="1125" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-3" target="wXwFH-dKUn-sAPGMIvJl-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-3" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;AtomicObjectProcessor::complete()&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="110" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-7" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-4" target="wXwFH-dKUn-sAPGMIvJl-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-4" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;RGWRados::Object::Write::write_meta()&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="210" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-5" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;_do_write_meta(&lt;/span&gt;assume_noent=1&lt;span style=&quot;font-size: 12px;&quot;&gt;)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="380" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-10" target="wXwFH-dKUn-sAPGMIvJl-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-10" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;get_state()&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;由于&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;assume_noent=1（假定不存在）&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;所以从RGWObjectCtx中取不到state也不查询底层RADOS&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;而是直接创建并返回一个空的state{exists=0, has_attrs=1, has_manifest=0, obj_tag=&quot;&quot;}&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="500" width="330" height="170" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-40" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-11" target="wXwFH-dKUn-sAPGMIvJl-39" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-11" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;prepare_atomic_modification(reset_obj=1&lt;/span&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;ol&gt;&lt;li style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;再次get_state(): 这次从&lt;/span&gt;RGWObjectCtx取到上一步创建的空state{exists=0, has_attrs=1, has_manifest=0,, obj_tag=&quot;&quot;}&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;由于state是空的，所以，need_guard=false;&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;op.create(true); 这不是立即执行op，而是在op中记录一个create head_obj操作。&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;注意true至关重要：它表示exclusive，即执行create操作时，若head_obj已经存在，则返回-EEXISTS(-17)&lt;/font&gt;&lt;/b&gt;；和POSIX文件系统的open(O_EXCL|O_CREAT)类似；&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;op.setxattr(RGW_ATTR_ID_TAG, bl); 这不是立即执行op，而是在op中记录一个setxattr操作，给head_obj设置tag。&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;这里设置tag也至关重要：tag是req_id，是唯一的。所以每个s3-obj有唯一的tag；3-obj被覆盖tag也变化&lt;/font&gt;&lt;/b&gt;。假定tag=unique_tag_req_id_XXX;&lt;/li&gt;&lt;/ol&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="730" width="330" height="320" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-13" target="wXwFH-dKUn-sAPGMIvJl-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-13" value="ref.ioctx.operate()&lt;br&gt;&lt;br&gt;&lt;ul&gt;&lt;li style=&quot;text-align: left;&quot;&gt;因为是覆盖写s3-obj，底层head_obj已经存在；&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;所以，operate失败，返回-EEXISTS(-17)&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;&lt;font color=&quot;#ff3333&quot;&gt;&lt;b&gt;原因：上一步prepare_atomic_modification，设置了op.create(true)，表示exclusive；&lt;/b&gt;&lt;/font&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="1400" width="330" height="140" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-14" value="&lt;ul&gt;&lt;li&gt;清除RGWObjectCtx中的state；&lt;/li&gt;&lt;li&gt;返回-EEXISTS(-17)；&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="110" y="1590" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-15" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-5" target="wXwFH-dKUn-sAPGMIvJl-10" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="380" y="400" as="sourcePoint" />
            <mxPoint x="430" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-14" target="wXwFH-dKUn-sAPGMIvJl-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="285" y="1060" as="sourcePoint" />
            <mxPoint x="620" y="700" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-21" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;_do_write_meta(&lt;/span&gt;assume_noent=0&lt;span style=&quot;font-size: 12px;&quot;&gt;)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="800" y="380" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-23" target="wXwFH-dKUn-sAPGMIvJl-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-23" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;get_state()&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;ul&gt;&lt;li&gt;RGWObjectCtx中的state已被清除，所以取不到；&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;但此次&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;assume_noent=0（假定存在）；&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;所以查询底层RADOS；&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;创建并返回查到的state{exists=1, has_attrs=1, has_manifest=1, obj_tag=unique_tag_req_id_AAA}&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="800" y="500" width="330" height="170" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-25" target="wXwFH-dKUn-sAPGMIvJl-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-25" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;prepare_atomic_modification(reset_obj=1&lt;/span&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;ol&gt;&lt;li style=&quot;text-align: left;&quot;&gt;&lt;span style=&quot;font-size: 12px;&quot;&gt;再次get_state(): 返回上一步创建的&lt;/span&gt;state{exists=1, has_attrs=1, has_manifest=1, obj_tag=unique_tag_req_id_AAA}&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;need_guard=true；&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;op.cmpxattr(RGW_ATTR_ID_TAG, LIBRADOS_CMPXATTR_OP_EQ, unique_tag_req_id_AAA);&amp;nbsp; &lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;在op中记录cmpxattr操作。这是一个原子&quot;check-and-put&quot;：本op覆盖的head_obj必须是tag=&amp;nbsp;unique_tag_req_id_AAA。假如有并发的op，写入了一个tag=unique_tag_req_id_BBB的版本，或者把它删掉了，那么本op就会失败，RADOS层会返回-ECANCELED(-125)，或者-ENOENT(-2);&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;op.create(false);&amp;nbsp; 记录本op不是exclusive create；&lt;br&gt;&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;store-&amp;gt;remove_rgw_head_obj(op); 在op中记录：删掉被覆盖的head_obj;&lt;br&gt;&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;op.setxattr(RGW_ATTR_ID_TAG, bl); 设置tag=&amp;nbsp;unique_tag_req_id_XXX; 由于这次只是重试，req_id没有变，所以还是unique_tag_req_id_XXX；&amp;nbsp;&lt;/li&gt;&lt;/ol&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="800" y="730" width="330" height="340" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-26" target="wXwFH-dKUn-sAPGMIvJl-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-26" value="ref.ioctx.operate()&lt;br&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="800" y="1380" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-27" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-21" target="wXwFH-dKUn-sAPGMIvJl-23" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1070" y="400" as="sourcePoint" />
            <mxPoint x="1120" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-28" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-4" target="wXwFH-dKUn-sAPGMIvJl-21" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="684.46" y="310" as="sourcePoint" />
            <mxPoint x="489.99571428571426" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-29" value="假设if_match和if_nomatch都为NULL，则乐观假定不存在&lt;br&gt;assume_noent=1&lt;br&gt;（否则显然应该假定存在）" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="220" y="260" width="190" height="90" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-30" value="乐观的代价：重试&lt;br&gt;assume_noent=0，假定存在" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="820" y="290" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-47" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-33" target="wXwFH-dKUn-sAPGMIvJl-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-33" value="complete_atomic_modification()&lt;br&gt;&lt;br&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;has_manifest=1：见前面从RADOS层查询到的state；&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;keep_tail=0: 不保留被覆盖的s3-obj的tail objs;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;所以调用&lt;/span&gt;update_gc_chain和send_chain：在gc列表中记录被覆盖的&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;arcSize=13;" parent="1" vertex="1">
          <mxGeometry x="800" y="1590" width="330" height="150" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-34" target="wXwFH-dKUn-sAPGMIvJl-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-55" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-26" target="wXwFH-dKUn-sAPGMIvJl-57" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1375" y="1490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-34" value="operate成功&lt;br&gt;即没有并发op，我们成功覆盖了tag=&lt;span style=&quot;text-align: left;&quot;&gt;&amp;nbsp;unique_tag_req_id_AAA的head_obj;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="800" y="1490" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-39" target="wXwFH-dKUn-sAPGMIvJl-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-39" value="index_op-&amp;gt;prepare()" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="110" y="1090" width="330" height="240" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-42" target="wXwFH-dKUn-sAPGMIvJl-26" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="965" y="1330" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-42" value="不需要 index_op-&amp;gt;prepare()，因为本次是重试，之前已经prepare过了。" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="800" y="1150" width="330" height="100" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-49" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-46" target="wXwFH-dKUn-sAPGMIvJl-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-46" value="index_op-&amp;gt;complete()" style="whiteSpace=wrap;html=1;rounded=1;arcSize=13;" parent="1" vertex="1">
          <mxGeometry x="800" y="1800" width="330" height="250" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-53" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wXwFH-dKUn-sAPGMIvJl-48" target="wXwFH-dKUn-sAPGMIvJl-52" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-48" value="记录quota" style="whiteSpace=wrap;html=1;rounded=1;arcSize=13;" parent="1" vertex="1">
          <mxGeometry x="800" y="2100" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-52" value="返回0；" style="whiteSpace=wrap;html=1;rounded=1;arcSize=13;" parent="1" vertex="1">
          <mxGeometry x="800" y="2200" width="330" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wXwFH-dKUn-sAPGMIvJl-57" value="operate失败&lt;br&gt;&lt;ol&gt;&lt;li style=&quot;text-align: left;&quot;&gt;返回-ECANCELED(-125)或者-ENOENT(-2)&lt;/li&gt;&lt;ul&gt;&lt;li style=&quot;text-align: left;&quot;&gt;index_op-&amp;gt;cancel();&lt;/li&gt;&lt;li style=&quot;text-align: left;&quot;&gt;返回成功：&lt;b&gt;&lt;font color=&quot;#ff3333&quot;&gt;操作失败了，也cancel了，为什么返回成功呢？因为有并发的op写入了一个新的版本，或者把对象删了。那么，认为本op在它们之前就可以了：本op成功了，但被并发的op覆盖了。&lt;/font&gt;&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;li style=&quot;text-align: left;&quot;&gt;返回其他错误：&lt;/li&gt;&lt;ul&gt;&lt;li style=&quot;text-align: left;&quot;&gt;返回失败；&lt;/li&gt;&lt;/ul&gt;&lt;/ol&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1200" y="1490" width="330" height="200" as="geometry" />
        </mxCell>
        <mxCell id="5meoEqljls3HWVcLkiu6-1" value="&lt;h1&gt;说明：&lt;/h1&gt;&lt;p&gt;Multiupload在upload一个part时，是不可能在write_meta()中发生冲突或者覆盖的。因为part的冲突是在MultipartObjectProcessor::process_first_chunk()中解决的，方法一样：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;op.create(true); //类似于posix的 O_CREAT | O_EXCL&lt;/li&gt;&lt;li&gt;检查返回值是否为-EEXIST；若是则重新生成对象名，并重写。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1160" y="140" width="480" height="180" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="VB7LKRKYvzQqBwja9E4P" name="Multipload的索引">
    <mxGraphModel dx="3541" dy="4307" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-3" value="&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;UploadMeta对象:&amp;nbsp;&lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;{bucketId}__multipart_{objectName}.{uploadId}.meta&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;data&lt;/b&gt;&lt;font face=&quot;Courier New&quot;&gt;:&amp;nbsp;multipart_upload_info&lt;/font&gt;（只有dest_placement）&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;attr&lt;/b&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;:&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 1;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;user.rgw.acl&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;user.rgw.content_type&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;user.rgw.pg_ver&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;user.rgw.source_zone&lt;/span&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;omap: &lt;/b&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;空&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-810" y="-840" width="690" height="320" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-5" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.non-ec&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="-680" y="-840" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-6" value="&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;BucketShard对象:&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;.dir.{bucketId}.{shardId}&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;data&lt;/b&gt;&lt;font face=&quot;Courier New&quot;&gt;: 空&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;attr&lt;/b&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;: 空&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;omap:&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;_multipart_{objectName}.{uploadId}.meta =&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;rgw_bucket_dir_entry&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-70" y="-840" width="700" height="320" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-7" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.index&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="65" y="-840" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-8" value="&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;UploadMeta对象:&amp;nbsp;&lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;{bucketId}__multipart_{objectName}.{uploadId}.meta&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;data&lt;/b&gt;&lt;font face=&quot;Courier New&quot;&gt;:&amp;nbsp;multipart_upload_info&lt;/font&gt;（只有dest_placement）&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;attr&lt;/b&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;:&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;line-height: 1;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; user.rgw.acl&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; user.rgw.content_type&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; user.rgw.pg_ver&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; user.rgw.source_zone&lt;/span&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;omap:&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;part.00000001 =&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;RGWUploadPartInfo{part-number,size,etag}&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;part.00000002 =&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;RGWUploadPartInfo&lt;/span&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;{part-number,size,etag}&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-810" y="-320" width="690" height="380" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-9" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.non-ec&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="-720" y="-320" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-10" value="&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;BucketShard对象:&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;.dir.{bucketId}.{shardId}&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;data&lt;/b&gt;&lt;font face=&quot;Courier New&quot;&gt;: 空&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;attr&lt;/b&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;: 空&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;omap:&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;_multipart_{objectName}.{uploadId}.meta =&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;rgw_bucket_dir_entry&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;span style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;_multipart_{objectName}.{uploadId}.1&amp;nbsp; &amp;nbsp; =&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;rgw_bucket_dir_entry&lt;/span&gt;&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; _multipart_{objectName}.{uploadId}.2&amp;nbsp; &amp;nbsp; =&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;rgw_bucket_dir_entry&lt;/span&gt;&lt;span style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-70" y="-320" width="700" height="380" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-11" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.index&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="65" y="-320" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-12" value="&lt;p style=&quot;line-height: 1.1;&quot;&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 1.1;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象: &lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;{bucketId}__multipart_{objectName}.{uploadId}.1&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.1_1&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__multipart_{objectName}.{uploadId}.2&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.2_1&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="680" y="-320" width="700" height="380" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-13" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.data&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="815" y="-320" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-15" value="&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;BucketShard对象:&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;.dir.{bucketId}.{shardId}&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;data&lt;/b&gt;&lt;font face=&quot;Courier New&quot;&gt;: 空&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;attr&lt;/b&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;: 空&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;omap:&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#ff0000&quot;&gt;objectName =&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;rgw_bucket_dir_entry&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-60" y="180" width="700" height="460" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-16" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.index&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="65" y="180" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-17" value="&lt;p style=&quot;line-height: 0.4;&quot;&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象: &lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;{bucketId}__multipart_{objectName}.{uploadId}.1&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.1_1&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__multipart_{objectName}.{uploadId}.2&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.2_1&lt;/font&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Head对象:&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;{bucketId}_{objectName}&lt;/span&gt;&lt;/font&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; data：空&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; omap：空&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; attr:&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;&quot; face=&quot;Courier New&quot;&gt;user.rgw.acl&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;user.rgw.etag&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;user.rgw.idtag&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;user.rgw.manifest&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;......&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;span style=&quot;background-color: initial; font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="680" y="180" width="700" height="460" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-18" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.data&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="815" y="180" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-21" value="&lt;p style=&quot;line-height: 1.1;&quot;&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 1.1;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象: &lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;{bucketId}__multipart_{objectName}.{uploadId}.1&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.1_1&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__multipart_{objectName}.{uploadId}.2&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.2_1&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;span style=&quot;color: rgb(255, 0, 0); font-family: &amp;quot;Courier New&amp;quot;; font-size: 20px; text-align: right;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 待gc，默认2小时之后被删除&lt;/span&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="680" y="800" width="700" height="380" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-22" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.buckets.data&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="815" y="800" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-23" value="&lt;p style=&quot;line-height: 1.1;&quot;&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 1.1;&quot;&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;队列对象: &lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;gc.{队列号}&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;omap:&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;0_2~JRV7CqECIB4moEvRYfILh9D3Pf-YY9g =&amp;gt;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;cls_rgw_gc_obj_info&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;1_01662118734.935939473&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp;=&amp;gt;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;cls_rgw_gc_obj_info&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;background-color: initial; font-size: 16px;&quot; color=&quot;#ff0000&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&lt;br&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;background-color: initial; font-size: 16px;&quot; color=&quot;#ff0000&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;这2条记录的内容完全一样，只是一个按时间排序，一个按uploadId排序，内&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;background-color: initial; font-size: 16px; color: rgb(255, 0, 0); font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;容都是&lt;/b&gt;&lt;span style=&quot;background-color: initial; font-size: 16px; color: rgb(255, 0, 0);&quot;&gt;default.rgw.buckets.data中的待gc的数据对象&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1440" y="800" width="700" height="380" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-24" value="&lt;h1 style=&quot;text-align: left;&quot;&gt;default.rgw.log:gc&lt;/h1&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="1575" y="800" width="430" height="60" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-25" value="&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 0.5;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;BucketShard对象:&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;.dir.{bucketId}.{shardId}&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;data&lt;/b&gt;&lt;font face=&quot;Courier New&quot;&gt;: 空&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;attr&lt;/b&gt;&lt;span style=&quot;font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px; background-color: initial;&quot;&gt;: 空&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;omap:&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;; font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#ff0000&quot;&gt;objectName =&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;rgw_bucket_dir_entry&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-60" y="1360" width="700" height="460" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-26" value="&lt;p style=&quot;line-height: 1.1;&quot;&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 1.1;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象: &lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;{bucketId}__multipart_{objectName}.{uploadId}.1&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b&gt;&lt;font color=&quot;#ff0000&quot;&gt; --&amp;gt;待gc&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.1_1&amp;nbsp; &amp;nbsp;&lt;font color=&quot;#ff0000&quot;&gt;&lt;b&gt;--&amp;gt;待gc&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__multipart_{objectName}.{uploadId}.2&amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b&gt; &lt;font color=&quot;#009900&quot;&gt;--&amp;gt; 被complete&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;Data对象:&amp;nbsp;&lt;/font&gt;{bucketId}__shadow_{objectName}.{uploadId}.2_1&amp;nbsp; &amp;nbsp;&lt;b&gt;&lt;font color=&quot;#009900&quot;&gt;--&amp;gt; 被complete&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;&lt;span style=&quot;color: rgb(255, 0, 0); font-family: &amp;quot;Courier New&amp;quot;; font-size: 20px; text-align: right;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="680" y="1360" width="700" height="450" as="geometry" />
        </mxCell>
        <mxCell id="avcEsRKwT2AKpVUQVyfQ-27" value="&lt;p style=&quot;line-height: 1.1;&quot;&gt;&lt;/p&gt;&lt;blockquote style=&quot;margin: 0px 0px 0px 40px; border: none; padding: 0px; line-height: 1.1;&quot;&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font style=&quot;font-size: 18px;&quot;&gt;队列对象: &lt;/font&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;gc.{队列号}&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp;&lt;font face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;omap:&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;font face=&quot;Courier New&quot;&gt;&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;0_2~JRV7CqECIB4moEvRYfILh9D3Pf-YY9g =&amp;gt;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;cls_rgw_gc_obj_info&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 14px;&quot;&gt;&lt;font color=&quot;#ff0000&quot;&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;; background-color: initial;&quot;&gt;1_01662118734.935939473&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp;=&amp;gt;&amp;nbsp;&lt;/b&gt;&lt;b style=&quot;background-color: initial; font-size: 14px; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;cls_rgw_gc_obj_info&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 16px;&quot;&gt;&lt;b style=&quot;font-size: 14px; background-color: initial; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 16px;&quot;&gt;&lt;font color=&quot;#009900&quot;&gt;&lt;font style=&quot;background-color: initial;&quot;&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;这2条记录的内容完全一样，只是一个按时间排序，一个按uploadId排序，内&lt;/b&gt;&lt;/font&gt;&lt;b style=&quot;background-color: initial; font-family: &amp;quot;Courier New&amp;quot;;&quot;&gt;容都是&lt;/b&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;default.rgw.buckets.data中的待gc的数据对象，实例中的第1个part。&lt;/span&gt;&lt;/font&gt;&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;span style=&quot;font-size: 14px; background-color: initial;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1430" y="1360" width="700" height="450" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-1" value="" style="endArrow=none;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#009900;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-910" y="-420" as="sourcePoint" />
            <mxPoint x="1411.1764705882354" y="-420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-2" value="" style="endArrow=none;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#009900;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-920" y="130" as="sourcePoint" />
            <mxPoint x="1401.1764705882351" y="130" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-3" value="" style="endArrow=none;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#009900;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-880.59" y="720" as="sourcePoint" />
            <mxPoint x="1440.5864705882352" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-4" value="" style="endArrow=none;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#009900;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-880.5900000000006" y="1280" as="sourcePoint" />
            <mxPoint x="1440.586470588236" y="1280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-5" value="" style="endArrow=none;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#009900;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-850.0000000000006" y="1960" as="sourcePoint" />
            <mxPoint x="1471.1764705882358" y="1960" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-6" value="" style="endArrow=none;html=1;rounded=0;fillColor=#f8cecc;strokeColor=#009900;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-920" y="-939" as="sourcePoint" />
            <mxPoint x="1401.1764705882351" y="-939" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-7" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;Initialized&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-930" y="-710" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-8" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;Uploading&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-920" y="-170" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-9" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;Completed&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-910" y="360" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-10" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;Aborted&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-920" y="950" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-11" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;Completed&lt;br&gt;with selected parts&lt;br&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-940" y="1540" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-18" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="80" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-14" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="fPdqc7nIdEiWRIukQ0tm-18" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-15" value="part4" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-18" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-19" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="360" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-20" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="fPdqc7nIdEiWRIukQ0tm-19" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-21" value="part5" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-19" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-22" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-760" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-23" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#B3B3B3;" parent="fPdqc7nIdEiWRIukQ0tm-22" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-24" value="part1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-22" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-25" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-480" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-26" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#B3B3B3;" parent="fPdqc7nIdEiWRIukQ0tm-25" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-27" value="part2" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-25" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-28" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-200" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-29" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#B3B3B3;" parent="fPdqc7nIdEiWRIukQ0tm-28" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-30" value="part3" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-28" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-31" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="640" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-32" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="fPdqc7nIdEiWRIukQ0tm-31" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-33" value="part6" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-31" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-34" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="920" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-35" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="fPdqc7nIdEiWRIukQ0tm-34" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-36" value="part7" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-34" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-43" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-480" y="2200" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-44" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="-200" y="2200" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-45" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="640" y="2200" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-46" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="920" y="2200" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-47" value="&lt;h1&gt;Complete操作从UploadMeta list_parts之后：&lt;/h1&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;part1：上传失败，complete不包含它，也list不到它；&amp;nbsp; &lt;font color=&quot;#0000ff&quot;&gt;&amp;nbsp;&lt;b&gt;--&amp;gt; 跳过&lt;/b&gt;&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;part2：上传失败，complete不包含它，也list不到它，但有一个重试op在进行中，且这个重试op:&amp;nbsp; &amp;nbsp; &lt;font color=&quot;#ff0000&quot;&gt;--&amp;gt; 空间泄漏，如何避免？&lt;/font&gt;&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;查询UploadMeta成功(complete操作未完成，所以还未删除UploadMeta);&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;上传数据、记录index成功；&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&lt;font style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;更新UploadMeta成功(complete操作未完成，所以还未删除UploadMeta)；&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;part3：上传失败，complete不包含它，也list不到它，但有一个重试op在进行中，且这个重试op:&amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;font color=&quot;#ff0000&quot;&gt;--&amp;gt; 空间泄漏，如何避免？&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;查询UploadMeta成功(complete操作未完成，所以还未删除UploadMeta);&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;上传数据、记录index成功；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;更新UploadMeta失败(complete操作已完成，UploadMeta被删除)；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;part4：上传成功，且complete包含它；&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;font color=&quot;#009900&quot;&gt;--&amp;gt; 正常的分片&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;part5：上传成功，complete不包含它，但能list到它；&amp;nbsp; &amp;nbsp;&lt;b style=&quot;&quot;&gt;&lt;font color=&quot;#0000ff&quot;&gt;--&amp;gt; 删除&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;part6：上传成功，complete不包含它，但能list到它，且一个重试op在进行中；&amp;nbsp; &amp;nbsp;&lt;b&gt;&lt;font color=&quot;#0000ff&quot;&gt;--&amp;gt; 删除，同part5&lt;/font&gt;&lt;/b&gt;&amp;nbsp;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;查询UploadMeta成功(complete操作未完成，所以还未删除UploadMeta);&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;上传数据、记录index成功；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;更新UploadMeta成功(complete操作未完成，所以还未删除UploadMeta)；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;part7：上传成功，complete不包含它，但能list到它，且一个重试op在进行中；&amp;nbsp; &amp;nbsp;&lt;b&gt;&lt;font color=&quot;#0000ff&quot;&gt;--&amp;gt; 删除，同part5&lt;/font&gt;&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;查询UploadMeta成功(complete操作未完成，所以还未删除UploadMeta);&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;上传数据、记录index成功；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;更新UploadMeta失败(complete操作已完成，UploadMeta被删除)；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;part8：上传成功，complete包含它，但一个重试op在进行中；&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#009900&quot;&gt;--&amp;gt; 无须处理，同part4&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;查询UploadMeta成功(complete操作未完成，所以还未删除UploadMeta);&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;上传数据、记录index成功；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;更新UploadMeta成功(complete操作未完成，所以还未删除UploadMeta)；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;part9：上传成功，complete包含它，但一个重试op在进行中；&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;font color=&quot;#009900&quot;&gt;--&amp;gt; 无须处理，同part4。模拟：complete之后，再upload（改代码绕过UploadMeta查询）&lt;/font&gt;&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;查询UploadMeta成功(complete操作未完成，所以还未删除UploadMeta);&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;上传数据、记录index成功；&lt;/p&gt;&lt;p style=&quot;font-size: 26px;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;更新UploadMeta失败(complete操作已完成，UploadMeta被删除)；&lt;/p&gt;" style="text;html=1;strokeColor=default;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontSize=24;" parent="1" vertex="1">
          <mxGeometry x="-760" y="2620" width="2520" height="1700" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-48" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1200" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-49" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="fPdqc7nIdEiWRIukQ0tm-48" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-50" value="part8" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-48" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-51" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1200" y="2200" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-52" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1480" y="2360" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-53" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="fPdqc7nIdEiWRIukQ0tm-52" vertex="1">
          <mxGeometry width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-54" value="part9" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;" parent="fPdqc7nIdEiWRIukQ0tm-52" vertex="1">
          <mxGeometry x="45" y="100" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-55" value="" style="rounded=1;whiteSpace=wrap;html=1;fontSize=24;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1480" y="2200" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-56" value="&lt;h1&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;MultiUpload的索引关系&lt;/font&gt;&lt;/h1&gt;&lt;div&gt;&lt;b style=&quot;color: rgb(255, 0, 0); font-family: &amp;quot;Courier New&amp;quot;; font-size: 28px;&quot;&gt;--------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/b&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b&gt;UploadMetaObject&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;Index&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;DataPart&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(在default.rgw.buckets.non-ec中)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (在default.rgw.buckets.index)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (在default.rgw.buckets.data中)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;b style=&quot;&quot;&gt;--------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&lt;b&gt;Initialized&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; data: multipart_upload_info&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;lt;---&amp;nbsp; &amp;nbsp; &amp;nbsp; UploadMetaObject的index&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;里面是dest_placement&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;attr: ...&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;omap: 空&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;b style=&quot;&quot;&gt;--------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&lt;b&gt;Uploading&lt;/b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; data: multipart_upload_info&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;lt;---&amp;nbsp; &amp;nbsp; &amp;nbsp; UploadMetaObject的index&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;里面是dest_placement&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;attr: ...&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;omap:&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; part.00000001=&amp;gt;RGWUploadPartInfo&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Part1的index&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ---&amp;gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Part1的head-object (Part1的shadow-object)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; part.00000002=&amp;gt;RGWUploadPartInfo&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; Part2的index&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ---&amp;gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Part2的head-object (Part2的shadow-object)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;b style=&quot;&quot;&gt;--------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&lt;b&gt;Completed&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Part1的head-object (Part1的shadow-object)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Part2的head-object (Part2的shadow-object)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;...&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b&gt;gc-index&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; S3-object的index&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ---&amp;gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;S3-object的head-object&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(在default.rgw.log:gc中)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;b&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&lt;b&gt;Aborted&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Part1的head-object (Part1的shadow-object)&amp;nbsp; &amp;nbsp; &amp;lt;---&amp;nbsp; &amp;nbsp; &amp;nbsp;2条index(回收所有part)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;Part2的head-object (Part2的shadow-object)&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;(一条按时间排序，一条按uploadID排序)&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#000000&quot; face=&quot;Courier New&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;...&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;font-size: 28px;&quot;&gt;&lt;font color=&quot;#ff0000&quot; face=&quot;Courier New&quot;&gt;&lt;b style=&quot;&quot;&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/b&gt;&lt;/font&gt;&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=#E6E6E6;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontSize=26;fontColor=#009900;" parent="1" vertex="1">
          <mxGeometry x="-944" y="-2890" width="3360" height="1830" as="geometry" />
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-101" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#FF0000;strokeWidth=2;fontFamily=Courier New;fontSize=30;fontColor=#FF0000;entryX=0.064;entryY=0.066;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="144" y="-1060" as="sourcePoint" />
            <mxPoint x="144.03999999999996" y="-2799.22" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-102" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#FF0000;strokeWidth=2;fontFamily=Courier New;fontSize=30;fontColor=#FF0000;entryX=0.064;entryY=0.066;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="-1060" as="sourcePoint" />
            <mxPoint x="800.04" y="-2799.22" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-103" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#FF0000;strokeWidth=2;fontFamily=Courier New;fontSize=30;fontColor=#FF0000;entryX=0.064;entryY=0.066;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1740" y="-1060" as="sourcePoint" />
            <mxPoint x="1740.04" y="-2799.22" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fPdqc7nIdEiWRIukQ0tm-104" value="" style="endArrow=none;html=1;rounded=0;dashed=1;strokeColor=#FF0000;strokeWidth=2;fontFamily=Courier New;fontSize=30;fontColor=#FF0000;entryX=0.064;entryY=0.066;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-730" y="-1060" as="sourcePoint" />
            <mxPoint x="-729.96" y="-2799.22" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="L3UKz-0z7KygIxHB36Kl" name="丢数据案例">
    <mxGraphModel dx="1841" dy="1007" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="E-6HqUKwKLA1-k6st9V9-2" value="" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="733" width="890" height="330" as="geometry" />
        </mxCell>
        <mxCell id="E-6HqUKwKLA1-k6st9V9-1" value="&lt;div class=&quot;lake-content&quot;&gt;&lt;h1 style=&quot;font-size: 28px; line-height: 36px; margin: 26px 0 10px 0&quot; data-lake-index-type=&quot;2&quot; id=&quot;fQFKa&quot;&gt;1. &lt;span class=&quot;ne-text&quot;&gt;complete不能重复&lt;/span&gt;&lt;/h1&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u43df299b&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;重复complete相当于 obj.version.2覆盖obj.version.1；导致的结果是，obj.version.1的数据被放进gc队列，将来被自动gc，留下obj.version.2。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uc41abb83&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;所以，同一个multiupload（同一份数据）&lt;/span&gt;&lt;strong&gt;假如&lt;/strong&gt;&lt;span class=&quot;ne-text&quot;&gt;能被重复complete的话，即obj.version.1和obj.version.2其实是同一份数据，最终导致数据被gc，即丢数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u153129b3&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;代码已经做了处理：第2个complete操作，会检查multiupload是否已经被complete，假如是，则返回失败：no such upload&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1 style=&quot;font-size: 28px; line-height: 36px; margin: 26px 0 10px 0&quot; data-lake-index-type=&quot;2&quot; id=&quot;TuAbe&quot;&gt;&lt;span&gt;2. &lt;/span&gt;&lt;span class=&quot;ne-text&quot;&gt;complete并发锁&lt;/span&gt;&lt;/h1&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u1ae1849a&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;并发是重复的一种特例：用户并发的发2个complete操作，其实也是重复complete。这通常因为重试而产生：即第1个complete失败，用户重试complete；&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uc3b74dfc&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;代码也做了处理，即引入一个serializer，其实现是一个分布式锁：RGWCompleteMultipart-Lock;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px; list-style: none&quot; class=&quot;ne-list-wrap&quot;&gt;&lt;ul style=&quot;margin: 0px; padding-left: 23px; list-style-position: initial; list-style-image: initial;&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uf06da904&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;init-multiuipload：创建一个UploadMetaObject&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ufb41208a&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;upload-part：把分片数据写入data pool；把分片的信息写入UploadMetaObject;&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ufa86d294&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;complete：&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px; list-style: none&quot; class=&quot;ne-list-wrap&quot;&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px; list-style: square&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u1d804b5a&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;lock UploadMetaObject/RGWCompleteMultipart-Lock;&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u66a14b1f&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;处理complete逻辑&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ub66d786d&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;remove UploadMetaObject；并发的complete尝试获取锁的时候，返回-ENOENT而失败，代码中：NOTICE: lock not exist; this multipart completion is already completed&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h1 style=&quot;font-size: 28px; line-height: 36px; margin: 26px 0 10px 0&quot; data-lake-index-type=&quot;2&quot; id=&quot;Zft1D&quot;&gt;&lt;span&gt;3. &lt;/span&gt;&lt;span class=&quot;ne-text&quot;&gt;丢数据案例1&lt;/span&gt;&lt;/h1&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u3d1c4a90&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;之前出过一个丢数据的案例：根因是重试的complete操作和第1个还是都锁成功了。&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u8e7b15d9&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;为什么RGWCompleteMultipart-Lock没起到保护作用呢？&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u11bcce3a&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;因为分布式锁不像内存锁lock之后一定要unlock打开，分布式锁有一个超时机制：即超过一定时间之后，自动打开。这是为了防止这种情况：1个instance锁住之后，进程重启了或者机器故障了，那么锁就永远不能打开。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u4d7a4469&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;RGWCompleteMultipart-Lock默认过期时间是10分钟。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u8d2e8f74&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;底层存储因为慢盘而卡住，导致complete卡住。比如11分钟的时候，底层存储才恢复，这时候锁已经过期了，重试的complete也能锁成功，就和第1个complete操作发生覆盖。导致丢数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u30815729&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;解决方案：增大过期时间到60分钟。认为：60分钟之内，底层存储肯定能恢复(god bless)。&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u35583345&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 style=&quot;font-size: 28px; line-height: 36px; margin: 26px 0 10px 0&quot; data-lake-index-type=&quot;2&quot; id=&quot;aaW37&quot;&gt;&lt;span&gt;4. &lt;/span&gt;&lt;span class=&quot;ne-text&quot;&gt;丢数据案例2&lt;/span&gt;&lt;/h1&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u54bc243a&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;即使设置了60分钟，这次又丢数据了…… 因为用户的使用方式，upload-part和complete并发了：&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u213843ee&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;底层存储因为慢盘而卡住，所以complete超时失败；&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u77b1a53c&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;用户发现complete失败，就重新upload最后一个分片，然后再complete&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u6466072b&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;再看complete：&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px; list-style: none&quot; class=&quot;ne-list-wrap&quot;&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px; list-style: square&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u11caa740&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;lock UploadMetaObject/RGWCompleteMultipart-Lock;&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u639236b2&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;处理complete逻辑&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uf9a89de3&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;remove UploadMetaObject；后来的complete尝试获取锁的时候，返回-ENOENT而失败，代码中：NOTICE: lock not exist; this multipart completion is already completed&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u4325691b&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;第1个complete卡在remove UploadMetaObject，用户又upload最后一个分片。刚好底层存储恢复了，第1个complete remove UploadMetaObject成功之后，upload操作又重建了它：upload要记分片信息，所以会&lt;/span&gt;&lt;strong&gt;修改&lt;/strong&gt;&lt;span class=&quot;ne-text&quot;&gt;UploadMetaObject，其实这时它已经不存在了，实际效果是重建。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u9991c135&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;第2个complete到来的时候，锁是新建的，lock操作不会返回-ENOENT，故而一切正常，所以最终还是发生了重复complete，导致丢数据，见第1节。&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u0f6c4101&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;ubd559d19&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;解决办法：&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u8ad83393&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;从rgw逻辑上不易修改：因为multupload的设计逻辑是，先upload再complete，这两者并发的情况rgw没考虑到。并发也比较微妙，修改也难以保证不引入新bug。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u8ca3e1c7&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;所以，推荐用户更改使用方式。用户的使用方式不符合multi-upload的原意。&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;h1 style=&quot;border-color: var(--border-color); font-size: 28px; line-height: 36px; margin: 26px 0px 10px;&quot; data-lake-index-type=&quot;2&quot; id=&quot;aaW37&quot;&gt;5.&amp;nbsp;&lt;span style=&quot;border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;丢数据案例3&lt;/span&gt;&lt;/h1&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;&lt;div class=&quot;lake-content&quot;&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u5042429b&quot;&gt;发生场景：rgw设置了rados_osd_op_timeout=12秒&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u74837c47&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-0：用户upload一个分片，假设part6.&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u666ef1ae&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-1：过8秒未返回，用户重新upload part6. 成功。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uc40691cc&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;12秒之后，retry-0失败，返回408.&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uda683926&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;用户complete multiupload成功；&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ua9f14f49&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;但get object返回404.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;ufd90368e&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u60b06620&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;upload过程梳理：&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u804d0be2&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;step1：写数据：创建rados object:   {bucket_id}__multipart_{objectName}.{upload_id}.{partNumber}。注意，这一步是原子的：等价于posix O_CREAT|OEXCL。假如已经存在(返回-EEXIST)，则生成随机字符串替换掉{upload_id}，然后重写。Part的shadow objects正常写。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u31b8065a&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;step2：在default.rgw.buckets.index中创建index（和本案例不相关）。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u82178586&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;step3：在UploadMetaObject的omap中记录RGWUploadPartInfo，其中manifest指向part数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ue41f56ff&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;假如在step2/step3失败，则删掉step1中写入的rados object。&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;ud6ca1a89&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;ube06d552&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;根因：&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ub2626614&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-0的step1和step2正常成功，即创建了rados object: {bucket_id}__multipart_{objectName}.{upload_id}.6以及index。但retry-0在step3卡住了。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ufc43be20&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-1正常，但注意创建的数据object是{bucket_id}__multipart_{objectName}.&lt;/span&gt;&lt;strong&gt;&lt;span style=&quot;color: #DF2A3F; font-size: 16px&quot; class=&quot;ne-text&quot;&gt;{random}&lt;/span&gt;&lt;/strong&gt;&lt;span class=&quot;ne-text&quot;&gt;.6，并且成功在UploadMetaObject的omap中记录RGWUploadPartInfo，指向这个数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u14a121f6&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;这时，retry-0在step3卡了超过12s就失败了，然后删掉{bucket_id}__multipart_{objectName}.{upload_id}.6数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u3841df44&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;但是，超时的rados op在后端成功了：即成功修改了UploadMetaObject的omap，指向了被删除的{bucket_id}__multipart_{objectName}.{upload_id}.6数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u58c6f3e4&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;complete没有发现这个问题，就成功了。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ub79022b1&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;get时，读part6失败，返回404。&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u657e8432&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;u6cfc079d&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;复现：修改代码&lt;/span&gt;&lt;/p&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ud92c52bd&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-A：在step3前加sleep 60s；&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ucb96012c&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-B：在这60期间重传同一分片；&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;u2c442e80&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;retry-A：sleep 60s结束后，成功修改UploadMetaObject的omap。但为了模拟超时，强制返回ETIMEOUT（导致数据被删）&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;ub5b4e4c6&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;complete成功；&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uf6e65c21&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;get返回404;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;修复：&lt;/div&gt;&lt;ul style=&quot;margin: 0; padding-left: 23px&quot; class=&quot;ne-ul&quot;&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uf6e65c21&quot;&gt;找到{bucket_id}__multipart_{objectName}.&lt;strong style=&quot;background-color: initial; border-color: var(--border-color);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color); color: rgb(223, 42, 63); font-size: 16px;&quot; class=&quot;ne-text&quot;&gt;{random}&lt;/span&gt;&lt;/strong&gt;&lt;span style=&quot;background-color: initial; border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;.6，恢复了数据。&lt;/span&gt;&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uf6e65c21&quot;&gt;根因修复：删除rados_osd_op_timeout配置。&lt;/li&gt;&lt;li data-lake-index-type=&quot;0&quot; id=&quot;uf6e65c21&quot;&gt;类似案例：https://tracker.ceph.com/issues/10885&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin: 0; padding: 0; min-height: 24px&quot; class=&quot;ne-p&quot; id=&quot;ub5722bea&quot;&gt;&lt;span class=&quot;ne-text&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;border-color: var(--border-color);&quot; class=&quot;ne-text&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="30" y="20" width="880" height="1950" as="geometry" />
        </mxCell>
        <mxCell id="E-6HqUKwKLA1-k6st9V9-3" value="不对：UploadPart修改UploadMetaObject时原子检查对象存在的，不会重建。" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="970" y="883" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="E-6HqUKwKLA1-k6st9V9-4" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="E-6HqUKwKLA1-k6st9V9-3" target="E-6HqUKwKLA1-k6st9V9-2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="730" y="640" as="sourcePoint" />
            <mxPoint x="780" y="590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="rtGll3NjEKyhNOG8hCaQ" name="跨bucket拷贝S3-Obj">
    <mxGraphModel dx="1841" dy="1003" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-47" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="530" y="100" width="170" height="420" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-48" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="800" y="100" width="170" height="420" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-46" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="330" y="100" width="170" height="420" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-2" value="head&lt;div&gt;Rados-Object&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="120" y="120" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-3" value="source S3-Object" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="135" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-4" value="shadow-1&lt;div&gt;Rados-Object&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="340" y="120" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-5" value="shadow-2&lt;div&gt;Rados-Object&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="540" y="120" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-6" value="shadow-999&lt;div&gt;Rados-Object&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="810" y="120" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-7" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;......&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="730" y="120" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-11" value="head&lt;div&gt;Rados-Object&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="120" y="290" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-12" value="copy-1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="305" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-17" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="fCqRQ8PpbHZcGo4siaQt-2" target="fCqRQ8PpbHZcGo4siaQt-4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="400" y="500" as="sourcePoint" />
            <mxPoint x="450" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-28" value="" style="endArrow=none;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endFill=0;dashed=1;" edge="1" parent="1" target="fCqRQ8PpbHZcGo4siaQt-5">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="490" y="150" as="sourcePoint" />
            <mxPoint x="350" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-29" value="" style="endArrow=none;html=1;rounded=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endFill=0;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="fCqRQ8PpbHZcGo4siaQt-5" target="fCqRQ8PpbHZcGo4siaQt-6">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="140" as="sourcePoint" />
            <mxPoint x="770" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-30" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" edge="1" parent="1" source="fCqRQ8PpbHZcGo4siaQt-11" target="fCqRQ8PpbHZcGo4siaQt-4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="160" as="sourcePoint" />
            <mxPoint x="350" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-32" value="head&lt;div&gt;Rados-Object&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="120" y="450" width="150" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-33" value="copy-2" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="465" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-39" value="&lt;div&gt;&lt;b&gt;xattr refcount&lt;/b&gt;&lt;/div&gt;&lt;div&gt;[ ref-1 ]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="340" y="300" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-40" value="&lt;div&gt;&lt;b&gt;xattr refcount&lt;/b&gt;&lt;/div&gt;&lt;div&gt;[ ref-1 ]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="540" y="300" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-41" value="&lt;div&gt;&lt;b&gt;xattr refcount&lt;/b&gt;&lt;/div&gt;&lt;div&gt;[ ref-1 ]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="810" y="300" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-42" value="&lt;div&gt;&lt;b&gt;xattr refcount&lt;/b&gt;&lt;/div&gt;&lt;div&gt;[ ref-1, ref-2 ]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="340" y="460" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-43" value="&lt;div&gt;&lt;b&gt;xattr refcount&lt;/b&gt;&lt;/div&gt;&lt;div&gt;[ ref-1, ref-2 ]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="540" y="460" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-44" value="&lt;div&gt;&lt;b&gt;xattr refcount&lt;/b&gt;&lt;/div&gt;&lt;div&gt;[ ref-1, ref-2 ]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="810" y="460" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-45" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" edge="1" parent="1" source="fCqRQ8PpbHZcGo4siaQt-32" target="fCqRQ8PpbHZcGo4siaQt-4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="330" as="sourcePoint" />
            <mxPoint x="350" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-49" value="&lt;b&gt;pg log entry&lt;/b&gt;&lt;div&gt;bl: ref-1, ref-2&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="510" y="380" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-50" value="&lt;b&gt;pg log entry&lt;/b&gt;&lt;div&gt;bl: ref-1, ref-2&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="780" y="380" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-36" value="&lt;b&gt;pg log entry&lt;/b&gt;&lt;div&gt;bl: ref-1, ref-2&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="310" y="380" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-51" value="&lt;b&gt;pg log entry&lt;/b&gt;&lt;div&gt;bl: ref-1&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="510" y="220" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-52" value="&lt;b&gt;pg log entry&lt;/b&gt;&lt;div&gt;bl: ref-1&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="780" y="220" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fCqRQ8PpbHZcGo4siaQt-53" value="&lt;b&gt;pg log entry&lt;/b&gt;&lt;div&gt;bl: ref-1&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="310" y="220" width="100" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
